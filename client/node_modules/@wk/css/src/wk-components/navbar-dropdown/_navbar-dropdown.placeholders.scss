/////
/// Navbar dropdown
/// @since 0.18.0
/// @group wk-css.components.navbar-dropdown
/// @author [GPO](https://gpo.wolterskluwer.com/)
/////

/// Declares properties for navbar dropdown container
%wk-navbar-dropdown-container {
    @include wk-clearfix;
    background: $wk-navbar-dropdown-background-color;
    color: $wk-navbar-dropdown-color;
    display: none;

    #{$wk-navbar-dropdown-column-name}-group {
        @include wk-responsive-grid(
            (
                child: $wk-navbar-dropdown-column-name,
                flex: $wk-navbar-dropdown-column-flex,
                gutters: $wk-navbar-dropdown-column-gutters,
                mobile-count: $wk-navbar-dropdown-column-mobile-count,
                tablet-count: $wk-navbar-dropdown-column-tablet-count,
                desktop-count: $wk-navbar-dropdown-column-desktop-count
            )
        );
    }

    &.wk-navbar-dropdown-classic {
        overflow: hidden;

        .wk-nav > li {
            position: relative;
        }
    }
}

/// Declares properties for navbar dropdown
%wk-navbar-dropdown {
    @include wk-viewport-insulate;

    padding-bottom: 0;
    padding-top: $wk-navbar-dropdown-top-gutter-mobile;

    @include breakpoint($wk-target-tablet-desktop) {
        padding-bottom: $wk-navbar-dropdown-bottom-gutter;
        padding-top: 0;
    }

    @include breakpoint($wk-desktop-max-width + (2 * $wk-page-content-padding)) {
        margin-left: auto;
        margin-right: auto;
        max-width: $wk-desktop-max-width;
    }

    #{$wk-navbar-dropdown-column-name} {
        padding-bottom: 0;
        padding-top: $wk-navbar-dropdown-container-gutter;

        @include breakpoint($wk-target-tablet-desktop) {
            padding-top: $wk-navbar-dropdown-default-gutter;
        }
    }

    &.wk-navbar-dropdown-classic {
        @include breakpoint($wk-desktop-max-width + (2 * $wk-page-content-padding)) {
            padding-left: $wk-page-content-padding;
            padding-right: $wk-page-content-padding;
        }
    }

    ul,
    li,
    dd,
    figure {
        margin: 0;
        padding: 0;
    }

    li {
        list-style-type: none;
    }

    .wk-dropdown-column-list,
    [wk-dropdown-column*='list'] {
        li,
        dt,
        dd {
            font-size: $wk-navbar-dropdown-list-item-font-size;
            line-height: $wk-navbar-dropdown-list-item-line-height;
            margin-bottom: $wk-navbar-dropdown-list-item-margin-bottom-mobile;

            @include breakpoint($wk-target-tablet-desktop) {
                margin-bottom: $wk-navbar-dropdown-list-item-margin-bottom;
            }

            &:hover {
                a {
                    background-color: inherit;
                }
            }
        }

        dt {
            opacity: $wk-navbar-dropdown-subhead-item-opacity;
        }

        a {
            color: $wk-navbar-dropdown-color;
            display: block;

            @include breakpoint($wk-target-tablet-desktop) {
                display: inline;
            }

            &:hover {
                text-decoration: underline;
            }
        }
    }

    li,
    dd > figcaption {
        margin-bottom: $wk-navbar-dropdown-list-item-margin-bottom;
    }
}

/// Describes visible dropdown condition
%wk-navbar-dropdown-visible {
    visibility: visible;
    opacity: 1;
    width: 100%;
    height: auto;

    @include breakpoint($wk-target-desktop) {
        transition: $wk-navbar-dropdown-transition;
        width: auto;

        > li > a {
            transition: $wk-navbar-dropdown-transition;
        }
    }

    > li > a {
        visibility: visible;
    }
}

/// Describes hidden dropdown condition
%wk-navbar-dropdown-hidden {
    visibility: hidden;
    opacity: 0;

    @include breakpoint($wk-target-desktop) {
        transition: $wk-navbar-dropdown-hover-transition;

        > li > a  {
            transition: $wk-navbar-dropdown-hover-transition;
        }
    }

    > li > a  {
        visibility: hidden;
    }
}

/// Describes link styles
%wk-navbar-link {
    color: $wk-navbar-dropdown-color;
    display: flex;
    justify-content: space-between;
    align-items: center;

    [wk-icon*=chevron],
    [class*=wk-icon-chevron] {
        margin-right: 0;
        margin-left: $wk-navbar-dropdown-icon-margin-left;
        font-size: $wk-navbar-dropdown-icon-size;
        width: $wk-navbar-dropdown-icon-size;
        height: $wk-navbar-dropdown-icon-size;
    }
}

/// Describes link active or hovered styles
%wk-navbar-link-active {
    > a {
        background-color: $wk-navbar-nested-active-dropdown-background-color;
        text-decoration: none;

        [wk-icon*=chevron],
        [class*=wk-icon-chevron] {
            transform: $wk-navbar-dropdown-icon-transform;

            @include breakpoint($wk-target-desktop) {
                transform: none;
            }
        }
    }
}

/// Describes multilevel dropdown default view
%wk-navbar-multilevel-dropdown-view-default {
    background: $wk-navbar-dropdown-background-color;
    padding: 0;

    li {
        font-size: $wk-navbar-dropdown-list-item-font-size;
        line-height: $wk-navbar-dropdown-list-item-line-height;
        list-style-type: none;
        margin: 0;

        @include wk-navbar-dropdown-active (
                $wk-navbar-multilevel-dropdown-hover-enabled,
                $wk-navbar-multilevel-dropdown-active-class-enabled
            ) {
            @extend %wk-navbar-link-active;
        }
    }

    a {
        @extend %wk-navbar-link;
        align-items: baseline;
        padding: $wk-navbar-nested-dropdown-link-padding;
        width: 100%;

        @include breakpoint($wk-target-tablet-desktop) {
            padding: $wk-navbar-nested-dropdown-link-padding-tablet-desktop;
        }

        @include breakpoint($wk-target-desktop) {
            white-space: nowrap;
        }
    }
}

/// Describes left-aligned multilevel dropdown behaviour
%wk-navbar-multilevel-dropdown-left-aligned {
    ul:not(.wk-navbar-dropdown) {
        @include breakpoint($wk-target-desktop) {
            left: auto;
            right: 100%;
        }
    }

    li {
        @include wk-navbar-dropdown-active (true, $wk-navbar-multilevel-dropdown-active-class-enabled){
            > a {
                [wk-icon*=chevron],
                [class*=wk-icon-chevron] {
                    @include breakpoint($wk-target-desktop) {
                        transform: rotate(180deg);
                    }
                }
            }
        }
    }
}

/// Describes multilevel dropdown behaviour
%wk-navbar-multilevel-dropdown {
    a + ul:not(.wk-navbar-dropdown) {
        @extend %wk-navbar-dropdown-hidden;
        @extend %wk-navbar-multilevel-dropdown-view-default;
        left: 0;
        right: 0;
        position: relative;

        @include breakpoint($wk-target-desktop) {
            left: 100%;
            right: auto;
            position: absolute;
            top: 0;
        }

        li {
            position: relative;
            @include wk-navbar-dropdown-active (
                $wk-navbar-multilevel-dropdown-hover-enabled,
                $wk-navbar-multilevel-dropdown-active-class-enabled
            ) {
                @extend %wk-navbar-link-active;
            }
        }

        &.wk-left-aligned {
            @extend %wk-navbar-multilevel-dropdown-left-aligned;
        }
    }

    @include wk-navbar-dropdown-active (
        $wk-navbar-multilevel-dropdown-hover-enabled,
        $wk-navbar-multilevel-dropdown-active-class-enabled
    ) {
        > a + ul:not(.wk-navbar-dropdown) {
            @extend %wk-navbar-dropdown-visible;
            border-bottom: $wk-navbar-nested-active-dropdown-border;

            @include breakpoint($wk-target-desktop) {
                border-bottom: none;
            }
        }

        &:last-child {
            > a + ul:not(.wk-navbar-dropdown) {
                border-bottom: none;
            }
        }
    }
}

/// Describes firstlevel dropdown behaviour
%wk-navbar-firstlevel-dropdown {
    > a {
        transition-delay: 0;
        @include wk-transition(background-color);

        & + ul:not(.wk-navbar-dropdown) {
            @include breakpoint($wk-target-tablet-desktop) {
                position: absolute;
            }

            @include breakpoint($wk-target-desktop) {
                left: auto;
                top: auto;
            }
        }

        [wk-icon*=chevron],
        [class*=wk-icon-chevron] {
            font-size: $wk-navbar-dropdown-icon-size;

            @include breakpoint($wk-target-tablet-desktop) {
                transform: $wk-navbar-dropdown-icon-transform;
            }
        }
    }

    @include wk-navbar-dropdown-active (
        true,
        $wk-navbar-multilevel-dropdown-active-class-enabled
    ) {
        > a {
            background-color: $wk-navbar-dropdown-background-color;

            [wk-icon*=chevron],
            [class*=wk-icon-chevron] {
                @include breakpoint($wk-target-desktop) {
                    transform: $wk-navbar-dropdown-icon-transform;
                }
            }
        }
    }
}
